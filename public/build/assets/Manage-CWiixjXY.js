import{r,j as e,L as _,$ as i,S as T}from"./app-B_H1sTXa.js";import{D as j,C as s}from"./column.esm-CBg18WJk.js";import{B as d}from"./button.esm-CvM3T8wv.js";import{T as M,a as b}from"./tabview.esm-BFutkbjR.js";import{I as g}from"./inputtext.esm-B6seoT3Q.js";import{A}from"./AuthenticatedLayout-BTNYEmlU.js";import"./index.esm-DxxmVuf0.js";import"./dropdown.esm-COSQCgxg.js";import"./csstransition.esm-N-po8r9f.js";import"./index.esm-N8m5rv-0.js";import"./index.esm-CvXa7yzG.js";import"./index.esm-Degx2bK-.js";import"./keyfilter.esm-BsAdckhT.js";import"./ApplicationLogo-KP1B-3Qc.js";import"./transition-ClnC5tZK.js";function H({auth:y,comments:l}){const[w,c]=r.useState(!1),[h,m]=r.useState(null),[N,P]=r.useState(0),[a,v]=r.useState([]),[n,C]=r.useState([]);r.useEffect(()=>{if(l){console.log("All comments:",l);const t=l.filter(o=>o.post_id&&o.post),f=l.filter(o=>o.warehouse_post_id);console.log("Post comments:",t),console.log("Warehouse comments:",f),v(t),C(f)}},[l]);const S=t=>{confirm("このコメントを削除してもよろしいですか？")&&(c(!0),T.delete(route("comments.destroy",t),{onFinish:()=>c(!1)}))},u=t=>{if(console.log(t),console.log(t),t.warehousePost)return e.jsx(i,{href:route("warehouse.posts.show",t.warehousePost.id),className:"text-blue-600 hover:underline",children:t.warehousePost.title});if(t.post)return e.jsx(i,{href:route("post.show",t.post.id),className:"text-blue-600 hover:underline",children:t.post.title})},p=t=>t.image_path?e.jsx("div",{className:"overflow-hidden w-16 h-16",children:e.jsx("img",{src:`/storage/${t.image_path}`,alt:"Comment image",className:"object-cover w-full h-full"})}):null,x=t=>e.jsxs("div",{className:"flex gap-2",children:[t.post&&e.jsx(i,{href:route("post.show",t.post.id),children:e.jsx(d,{icon:"pi pi-eye",className:"p-button-sm p-button-info"})}),t.warehousePost&&e.jsx(i,{href:route("warehouse.posts.show",t.warehousePost.id),children:e.jsx(d,{icon:"pi pi-eye",className:"p-button-sm p-button-info"})}),e.jsx(d,{icon:"pi pi-trash",className:"p-button-sm p-button-danger",onClick:()=>S(t.id),disabled:w})]});return e.jsxs(A,{user:y.user,header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"コメント管理"}),children:[e.jsx(_,{title:"コメント管理"}),e.jsx("div",{className:"py-12 pt-4",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 text-gray-900",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h3",{className:"text-lg font-medium",children:"あなたのコメント一覧"})}),e.jsxs(M,{activeIndex:N,onTabChange:t=>P(t.index),children:[e.jsxs(b,{header:"投稿コメント",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs("span",{className:"p-input-icon-left",children:[e.jsx("i",{className:"pi pi-search"}),e.jsx(g,{type:"search",placeholder:"検索...",onInput:t=>m(t.target.value)})]})}),a&&a.length>0?e.jsxs(j,{value:a,paginator:!0,rows:10,rowsPerPageOptions:[5,10,25,50],tableStyle:{minWidth:"50rem"},globalFilter:h,emptyMessage:"投稿コメントがありません",sortMode:"multiple",removableSort:!0,resizableColumns:!0,columnResizeMode:"fit",className:"p-datatable-sm",stripedRows:!0,children:[e.jsx(s,{field:"content",header:"コメント内容",sortable:!0,filter:!0,filterPlaceholder:"内容で検索",style:{width:"30%"},body:t=>t.content.length>100?`${t.content.substring(0,100)}...`:t.content}),e.jsx(s,{field:"title",header:"投稿",sortable:!0,filter:!0,filterPlaceholder:"投稿で検索",style:{width:"20%"},body:u}),e.jsx(s,{field:"image_path",header:"画像",style:{width:"10%"},body:p}),e.jsx(s,{field:"created_at",header:"作成日時",sortable:!0,filter:!0,filterPlaceholder:"日付で検索",style:{width:"15%"},body:t=>new Date(t.created_at).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"})}),e.jsx(s,{header:"アクション",style:{width:"15%"},body:x})]}):e.jsx("p",{children:"投稿コメントがありません。新しいコメントを作成してください。"})]}),e.jsxs(b,{header:"倉庫投稿コメント",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs("span",{className:"p-input-icon-left",children:[e.jsx("i",{className:"pi pi-search"}),e.jsx(g,{type:"search",placeholder:"検索...",onInput:t=>m(t.target.value)})]})}),n&&n.length>0?e.jsxs(j,{value:n,paginator:!0,rows:10,rowsPerPageOptions:[5,10,25,50],tableStyle:{minWidth:"50rem"},globalFilter:h,emptyMessage:"倉庫投稿コメントがありません",sortMode:"multiple",removableSort:!0,resizableColumns:!0,columnResizeMode:"fit",className:"p-datatable-sm",stripedRows:!0,children:[e.jsx(s,{field:"content",header:"コメント内容",sortable:!0,filter:!0,filterPlaceholder:"内容で検索",style:{width:"30%"},body:t=>t.content.length>100?`${t.content.substring(0,100)}...`:t.content}),e.jsx(s,{field:"title",header:"倉庫投稿",sortable:!0,filter:!0,filterPlaceholder:"倉庫投稿で検索",style:{width:"20%"},body:u}),e.jsx(s,{field:"image_path",header:"画像",style:{width:"10%"},body:p}),e.jsx(s,{field:"created_at",header:"作成日時",sortable:!0,filter:!0,filterPlaceholder:"日付で検索",style:{width:"15%"},body:t=>new Date(t.created_at).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"})}),e.jsx(s,{header:"アクション",style:{width:"15%"},body:x})]}):e.jsx("p",{children:"倉庫投稿コメントがありません。新しいコメントを作成してください。"})]})]})]})})})})]})}export{H as default};
