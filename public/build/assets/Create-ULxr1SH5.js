import{r as o,m as S,j as e,L as y,S as F}from"./app-BINiEKMl.js";import{A as L}from"./AuthenticatedLayout-CfRTpQnW.js";import{I as i}from"./InputLabel-B4l_X7_f.js";import{T as I}from"./TextInput--s5s1b0J.js";import"./TextArea-CA3VHKcP.js";import{S as P}from"./SelectInput-BDMP-O2I.js";import{I as C}from"./InputError-CqTlNqPr.js";import{P as E}from"./PrimaryButton-BqoHKMBQ.js";import{F as T}from"./fileupload.esm-D97rz0Pg.js";import"./ApplicationLogo-TVMI2P9A.js";import"./transition-lGd-ZDuB.js";import"./inputtext.esm-B2hRTqXa.js";import"./index.esm-BvSLdicA.js";import"./keyfilter.esm-khUV3pl6.js";import"./inputtextarea.esm-BjWNcd2M.js";import"./dropdown.esm-D8hLMgzJ.js";import"./csstransition.esm-BOLxvbPb.js";import"./index.esm-Tra6a9hq.js";import"./button.esm-1k4mVwBB.js";import"./index.esm-CtqB785C.js";function Z({auth:u,shops:p}){const[a,h]=o.useState(""),[r,x]=o.useState(""),[l,j]=o.useState(""),[n,f]=o.useState(null),{data:d,setData:m,post:v,errors:g}=S({title:a,content:r,shop_id:l,photo:null});o.useEffect(()=>{m({title:a,content:r,shop_id:l,photo:d.photo})},[a,r,l,m]);const N=t=>{t.preventDefault(),v("/admin/posts",d,{onSuccess:()=>F.push("/admin/posts"),onError:s=>{console.error("掲示板データの保存に失敗しました:",s)},forceFormData:!0})},b=t=>{const s=t.files[0];if(s){m("photo",s);const c=new FileReader;c.onload=w=>{f(w.target.result)},c.readAsDataURL(s)}};return e.jsxs(L,{user:u.user,header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"掲示板作成"}),children:[e.jsx(y,{title:"掲示板作成"}),e.jsx("div",{className:"py-12 pt-4",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6 text-gray-900",children:e.jsxs("form",{onSubmit:N,encType:"multipart/form-data",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"title",value:"タイトル"}),e.jsx(I,{id:"title",type:"text",className:"block mt-1 w-full",value:a,onChange:t=>h(t.target.value),required:!0,autoFocus:!0})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(i,{htmlFor:"content",value:"コンテンツ"}),e.jsx("textarea",{id:"content",className:"block mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",value:r,onChange:t=>x(t.target.value),required:!0,rows:"8"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(i,{htmlFor:"shop_id",value:"店舗"}),e.jsxs(P,{id:"shop_id",className:"block mt-1 w-full",value:l,onChange:t=>j(t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"店舗を選択してください"}),p.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(i,{htmlFor:"photo",value:"画像（オプション）"}),e.jsx(T,{id:"photo",name:"photo",accept:"image/*",maxFileSize:2e6,emptyTemplate:e.jsx("p",{className:"m-0",children:"ここに画像をドラッグ&ドロップするか、クリックしてアップロードしてください。"}),onSelect:b,chooseLabel:"選択",uploadLabel:"アップロード",cancelLabel:"キャンセル",className:"mt-1",auto:!0,customUpload:!0,uploadHandler:t=>t.options.clear()}),e.jsx(C,{message:g.photo,className:"mt-2"}),n&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"mb-2 text-sm",children:"プレビュー:"}),e.jsx("img",{src:n,alt:"Preview",className:"max-w-xs rounded-md"})]})]}),e.jsx("div",{className:"flex justify-end items-center mt-4",children:e.jsx(E,{type:"submit",children:"作成"})})]})})})})})]})}export{Z as default};
