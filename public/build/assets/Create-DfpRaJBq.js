import{r as a,m as y,j as e,L,S as F}from"./app-B_H1sTXa.js";import{A as C}from"./AuthenticatedLayout-BTNYEmlU.js";import{I as n}from"./InputLabel-BX0P0eNU.js";import{T as I}from"./TextInput-OFQM4A8H.js";import{T as P}from"./TextArea-CSI1Lwaf.js";import{S as T}from"./SelectInput-CY-C8iKg.js";import{I as c}from"./InputError-BCTRyRV3.js";import{P as k}from"./PrimaryButton-BcBVvMXy.js";import{F as E}from"./fileupload.esm-Bj2siJmu.js";import"./ApplicationLogo-KP1B-3Qc.js";import"./transition-ClnC5tZK.js";import"./inputtext.esm-B6seoT3Q.js";import"./index.esm-DxxmVuf0.js";import"./keyfilter.esm-BsAdckhT.js";import"./inputtextarea.esm-BzK3T2KJ.js";import"./dropdown.esm-COSQCgxg.js";import"./csstransition.esm-N-po8r9f.js";import"./index.esm-N8m5rv-0.js";import"./button.esm-CvM3T8wv.js";import"./index.esm-Degx2bK-.js";function $({auth:x,shops:j}){const[o,v]=a.useState(""),[l,f]=a.useState(""),[r,g]=a.useState(""),[d,p]=a.useState(null),{data:u,setData:i,post:N,errors:m}=y({title:o,content:l,shop_id:r,photo:null});a.useEffect(()=>{i({title:o,content:l,shop_id:r,photo:u.photo})},[o,l,r,i]);const w=t=>{t.preventDefault(),N("/admin/posts",u,{onSuccess:()=>F.push("/admin/posts"),onError:s=>{console.error("掲示板データの保存に失敗しました:",s)},forceFormData:!0})},b=t=>{const s=t.files[0];if(s){i("photo",s);const h=new FileReader;h.onload=S=>{p(S.target.result)},h.readAsDataURL(s)}};return e.jsxs(C,{user:x.user,header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"掲示板作成"}),children:[e.jsx(L,{title:"掲示板作成"}),e.jsx("div",{className:"py-12 pt-4",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6 text-gray-900",children:e.jsxs("form",{onSubmit:w,encType:"multipart/form-data",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"title",value:"タイトル"}),e.jsx(I,{id:"title",type:"text",className:"block mt-1 w-full",value:o,onChange:t=>v(t.target.value),required:!0,autoFocus:!0}),e.jsx(c,{message:m.title,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(n,{htmlFor:"content",value:"コンテンツ"}),e.jsx(P,{id:"content",value:l,className:"block mt-1 w-full",onChange:t=>f(t.target.value),rows:6,required:!0}),e.jsx(c,{message:m.content,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(n,{htmlFor:"shop_id",value:"店舗"}),e.jsxs(T,{id:"shop_id",className:"block mt-1 w-full",value:r,onChange:t=>g(t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"店舗を選択してください"}),j.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(c,{message:m.shop_id,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(n,{htmlFor:"photo",value:"画像（オプション）"}),e.jsx(E,{id:"photo",name:"photo",accept:"image/*",maxFileSize:2e6,emptyTemplate:e.jsx("p",{className:"m-0",children:"ここに画像をドラッグ&ドロップするか、クリックしてアップロードしてください。"}),onSelect:b,chooseLabel:"選択",uploadLabel:"アップロード",cancelLabel:"キャンセル",className:"mt-1",auto:!0,customUpload:!0,uploadHandler:t=>t.options.clear()}),e.jsx(c,{message:m.photo,className:"mt-2"}),d&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"mb-2 text-sm",children:"プレビュー:"}),e.jsxs("div",{className:"inline-block relative",children:[e.jsx("img",{src:d,alt:"Preview",className:"max-w-xs rounded-md"}),e.jsx("button",{type:"button",onClick:()=>{i("photo",null),p(null)},className:"absolute top-0 right-0 p-1 text-white bg-red-500 rounded-full hover:bg-red-700",style:{transform:"translate(50%, -50%)"},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})]}),e.jsx("div",{className:"flex justify-end items-center mt-4",children:e.jsx(k,{type:"submit",children:"作成"})})]})})})})})]})}export{$ as default};
