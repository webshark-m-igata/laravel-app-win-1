import{K as T,r as a,m as L,j as e,L as I,S as C}from"./app-yTh-YxTC.js";import{A as D}from"./AuthenticatedLayout-C_1Nqe5A.js";import{I as p}from"./InputLabel-CraIE3uT.js";import{T as E}from"./TextInput-C5NCLnli.js";import{T as U}from"./TextArea-kjxygfO0.js";import{S as k}from"./SelectInput-DYm0aztJ.js";import{I as d}from"./InputError-B2TmcUpv.js";import{P as A}from"./PrimaryButton-wFxxeskN.js";import{F as q}from"./fileupload.esm-zvskgpnF.js";import"./ApplicationLogo-DltNY-8b.js";import"./transition-CH8N47gP.js";import"./inputtext.esm-BfOPbrgO.js";import"./index.esm-BVyL3PfI.js";import"./keyfilter.esm-EpLhoag2.js";import"./inputtextarea.esm-Csy78Q1G.js";import"./dropdown.esm-BlF-AyOP.js";import"./csstransition.esm-qN3COFcs.js";import"./index.esm-lNuoExQj.js";import"./button.esm-BCdY-iGx.js";import"./index.esm-BnBFkcEY.js";function ae({auth:f}){const{post:o,shops:v}=T().props,[r,g]=a.useState(o.title),[l,N]=a.useState(o.content),[m,b]=a.useState(o.shop_id||""),[x,j]=a.useState(o.photo?`/storage/${o.photo}`:null),[c,w]=a.useState(!1),{data:h,setData:u,put:S,processing:P,errors:i}=L({title:r,content:l,shop_id:m,photo:null,delete_photo:!1,_method:"PUT"});a.useEffect(()=>{u({title:r,content:l,shop_id:m,photo:h.photo,delete_photo:c,_method:"PUT"})},[r,l,m,c,u]);const _=t=>{t.preventDefault();const s=new FormData;s.append("title",r),s.append("content",l),s.append("shop_id",m),s.append("_method","PUT"),s.append("delete_photo",c),h.photo&&s.append("photo",h.photo),S(`/admin/posts/${o.id}`,s,{onSuccess:()=>C.push("/admin/posts"),onError:n=>{console.error("掲示板データの更新に失敗しました:",n)}})},y=t=>{const s=t.files[0];if(s){u("photo",s);const n=new FileReader;n.onload=F=>{j(F.target.result)},n.readAsDataURL(s)}};return e.jsxs(D,{user:f.user,header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"掲示板編集"}),children:[e.jsx(I,{title:"掲示板編集"}),e.jsx("div",{className:"py-12 pt-4",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6 text-gray-900",children:e.jsxs("form",{onSubmit:_,encType:"multipart/form-data",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"title",value:"タイトル"}),e.jsx(E,{id:"title",type:"text",value:r,className:"block mt-1 w-full",isFocused:!0,onChange:t=>g(t.target.value),required:!0}),e.jsx(d,{message:i.title,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(p,{htmlFor:"content",value:"コンテンツ"}),e.jsx(U,{id:"content",value:l,className:"block mt-1 w-full",onChange:t=>N(t.target.value),rows:6,required:!0}),e.jsx(d,{message:i.content,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(p,{htmlFor:"shop_id",value:"店舗"}),e.jsxs(k,{id:"shop_id",className:"block mt-1 w-full",value:m,onChange:t=>b(t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"店舗を選択してください"}),v.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(d,{message:i.shop_id,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(p,{htmlFor:"photo",value:"画像（オプション）"}),e.jsx(q,{id:"photo",name:"photo",accept:"image/*",maxFileSize:2e6,emptyTemplate:e.jsx("p",{className:"m-0",children:"ここに画像をドラッグ&ドロップするか、クリックしてアップロードしてください。"}),onSelect:y,chooseLabel:"選択",uploadLabel:"アップロード",cancelLabel:"キャンセル",className:"mt-1",auto:!0,customUpload:!0,uploadHandler:t=>t.options.clear()}),e.jsx(d,{message:i.photo,className:"mt-2"}),x&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"mb-2 text-sm",children:"現在の写真（新しい写真をアップロードすると置き換えられます）:"}),e.jsx("img",{src:x,alt:"Preview",className:"max-w-xs rounded-md"}),e.jsx("button",{type:"button",className:"px-4 py-2 mt-2 text-sm text-red-600 hover:text-red-900",onClick:()=>{w(!0),j(null)},children:"画像を削除"})]})]}),e.jsx("div",{className:"flex gap-4 items-center mt-4",children:e.jsx(A,{disabled:P,children:"保存"})})]})})})})})]})}export{ae as default};
