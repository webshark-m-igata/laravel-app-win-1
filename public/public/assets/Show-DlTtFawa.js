import{m as y,r as I,j as e,S as L,$ as S,L as D}from"./app-B_Aeq8GW.js";import{A as P}from"./AuthenticatedLayout-CWqIHKsr.js";import{C as u}from"./card.esm-CyvKnkfD.js";import{I as C}from"./image.esm-9iXvFgYt.js";import{B as h}from"./button.esm-DrwfAxdm.js";import{I as p}from"./InputError-D7MLd3z_.js";import{P as F}from"./PrimaryButton-CsyAPDZH.js";import{I as _}from"./inputtextarea.esm-DxGZo2AR.js";import{F as T}from"./fileupload.esm-B3orI5Wk.js";import{I as U}from"./InputLabel-CSK8DwVh.js";import"./ApplicationLogo-5yfbdPk5.js";import"./transition-DyVRvZi1.js";import"./index.esm-CHdHxu-m.js";import"./csstransition.esm-MY6VGyxQ.js";import"./keyfilter.esm-xKEDHciX.js";import"./index.esm-QXpkl2S6.js";import"./index.esm-BBhWTQZi.js";function $({comments:t,warehousePostId:a,auth:r}){const{data:l,setData:i,post:m,processing:j,reset:g,errors:c}=y({content:"",image:null}),[o,d]=I.useState(null),N=s=>{s.preventDefault(),m(route("warehouse.comments.store",a),{onSuccess:()=>{g(),d(null)}})},f=s=>{const n=s.files[0];if(n){i("image",n);const x=new FileReader;x.onload=v=>{d(v.target.result)},x.readAsDataURL(n)}},w=s=>{confirm("このコメントを削除してもよろしいですか？")&&L.delete(route("warehouse.comments.destroy",s))},b=s=>new Date(s).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"mb-4 text-xl font-semibold",children:"コメント"}),e.jsxs("form",{onSubmit:N,className:"mb-6",encType:"multipart/form-data",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx(_,{value:l.content,onChange:s=>i("content",s.target.value),rows:3,placeholder:"コメントを入力してください",className:"p-2 w-full",required:!0}),e.jsx(p,{message:c.content,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(U,{htmlFor:"image",value:"画像（任意）"}),e.jsx(T,{id:"image",name:"image",accept:"image/*",maxFileSize:2e6,emptyTemplate:e.jsx("p",{className:"m-0",children:"ここに画像をドラッグ&ドロップするか、クリックしてアップロードしてください。"}),onSelect:f,chooseLabel:"選択",uploadLabel:"アップロード",cancelLabel:"キャンセル",className:"mt-1",auto:!0,customUpload:!0,uploadHandler:s=>s.options.clear()}),e.jsx(p,{message:c.image,className:"mt-2"}),o&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"mb-2 text-sm",children:"プレビュー:"}),e.jsx("img",{src:o,alt:"Preview",className:"max-w-xs rounded-md"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(F,{disabled:j,children:"コメントを投稿"})})]}),e.jsx("div",{className:"space-y-4",children:t&&t.length>0?t.map(s=>e.jsx(u,{className:"shadow-sm",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("i",{className:"mr-2 pi pi-user"}),e.jsx("span",{className:"font-semibold",children:s.user.name}),e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:b(s.created_at)})]}),e.jsx("p",{className:"whitespace-pre-wrap",children:s.content}),s.image_path&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:`/storage/${s.image_path}`,alt:"コメント画像",className:"mt-2 max-w-xs rounded-md"})})]}),r.user&&r.user.id===s.user_id&&e.jsx(h,{icon:"pi pi-trash",className:"p-button-rounded p-button-danger p-button-text",onClick:()=>w(s.id),tooltip:"削除"})]})},s.id)):e.jsx("p",{className:"py-4 text-center text-gray-500",children:"コメントはまだありません"})})]})}function Y({auth:t,post:a}){const r=a.photo?`/storage/${a.photo}`:null,l=new Date(a.created_at).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"mr-2 pi pi-user"}),e.jsx("span",{className:"font-semibold",children:a.user.name})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx("i",{className:"mr-2 pi pi-calendar"}),l]})]}),m=e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{children:[e.jsx("i",{className:"mr-2 pi pi-tag"}),e.jsx("span",{className:"text-sm",children:a.warehouse.name})]}),e.jsx(S,{href:route("warehouse.posts.index"),children:e.jsx(h,{label:"倉庫掲示板に戻る",icon:"pi pi-arrow-left",className:"p-button-sm"})})]});return e.jsxs(P,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"倉庫掲示板投稿詳細"}),children:[e.jsx(D,{title:"倉庫掲示板投稿詳細"}),e.jsx("div",{className:"py-12 pt-4",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsxs(u,{title:a.title,subTitle:a.warehouse.name,header:i,footer:m,className:"shadow-md",children:[e.jsx("div",{className:"mb-6 whitespace-pre-wrap",children:a.content}),r&&e.jsx("div",{className:"mt-4",children:e.jsx(C,{src:r,alt:"投稿画像",width:"100%",preview:!0})}),e.jsx($,{comments:a.comments,warehousePostId:a.id,auth:t})]})})})]})}export{Y as default};
